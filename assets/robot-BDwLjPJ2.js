import{b as P,S as A,C as G,i as D,H as I,D as M,h as O,g as R,j as T,G as j,W as z,k as B,l as N,m as U}from"./style-BuvN1NwK.js";import{S as q}from"./stats.module--VATS4Kh.js";import{g as J}from"./lil-gui.module.min-Bc0DeA9g.js";import{G as Y}from"./GLTFLoader-CTix8BNr.js";let m,E,F,h,a,w,s,x,d,t,r,W,b;const f={state:"Walking"};_();y();function _(){m=document.createElement("div"),document.getElementById("container").appendChild(m),d=new P(45,window.innerWidth/window.innerHeight,.25,100),d.position.set(-5,3,10),d.lookAt(0,2,0),t=new A,t.background=new G(14737632),t.fog=new D(14737632,20,100),F=new U;const n=new I(16777215,9276813,3);n.position.set(0,20,0),t.add(n);const i=new M(16777215,3);i.position.set(0,20,10),t.add(i);const c=new O(new R(2e3,2e3),new T({color:13355979,depthWrite:!1}));c.rotation.x=-Math.PI/2,t.add(c);const o=new j(200,40,0,0);o.material.opacity=.2,o.material.transparent=!0,t.add(o),new Y().load("robot/RobotExpressive.glb",function(l){W=l.scene,t.add(W),K(W,l.animations)},void 0,function(l){console.error(l)}),r=new z({antialias:!0}),r.setPixelRatio(window.devicePixelRatio),r.setSize(window.innerWidth,window.innerHeight),m.appendChild(r.domElement),window.addEventListener("resize",Q),E=new q,m.appendChild(E.dom)}function K(n,i){const c=["Idle","Walking","Running","Dance","Death","Sitting","Standing"],o=["Jump","Yes","No","Wave","Punch","ThumbsUp"];h=new J,a=new B(n),w={};for(let e=0;e<i.length;e++){const p=i[e],u=a.clipAction(p);w[p.name]=u,(o.indexOf(p.name)>=0||c.indexOf(p.name)>=4)&&(u.clampWhenFinished=!0,u.loop=N)}const g=h.addFolder("States");g.add(f,"state").options(c).onChange(function(){v(f.state,.5)}),g.open();const C=h.addFolder("Emotes");function H(e){f[e]=function(){v(e,.2),a.addEventListener("finished",L)},C.add(f,e)}function L(){a.removeEventListener("finished",L),v(f.state,.2)}for(let e=0;e<o.length;e++)H(o[e]);C.open(),b=n.getObjectByName("Head_4");const S=Object.keys(b.morphTargetDictionary),k=h.addFolder("Expressions");for(let e=0;e<S.length;e++)k.add(b.morphTargetInfluences,e,0,1,.01).name(S[e]);s=w.Walking,s.play(),k.open()}function v(n,i){x=s,s=w[n],x!==s&&x.fadeOut(i),s.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(i).play()}function Q(){d.aspect=window.innerWidth/window.innerHeight,d.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight)}function y(){const n=F.getDelta();a&&a.update(n),requestAnimationFrame(y),r.render(t,d),E.update()}
